version: 1.0.{build}
os: Visual Studio 2017
init:
- git config --global core.autocrlf true
install:
before_build:
- nuget restore
build:
  project: StyleCopAnalyzers.sln
  verbosity: minimal
test_script:
- cd "StyleCop.Analyzers\StyleCop.Analyzers.CodeFixes"
- nuget install OpenCover -Version 4.6.519 -OutputDirectory opencover
- .\opencover\OpenCover.4.6.519\tools\OpenCover.Console.exe -register:user -target:"-target:C:\Program Files\dotnet\dotnet.exe" -targetargs:"test" -returntargetcode -filter:"+[StyleCop*]*" -excludebyattribute:*.ExcludeFromCodeCoverage* -excludebyfile:*\*Designer.cs -hideskipped:All -output:.\StyleCopAnalyzers_coverage.xml
- "SET PATH=C:\\Python34;C:\\Python34\\Scripts;%PATH%"
- pip install codecov
- codecov -f "StyleCopAnalyzers_coverage.xml"
# preserve "packages" directory in the root of build folder but will reset it if packages.config is modified
cache:
  - packages -> **\packages.config
artifacts:
- path: 'StyleCop.Analyzers\**\*.vsix'
- path: 'StyleCop.Analyzers\**\*.nupkg'
